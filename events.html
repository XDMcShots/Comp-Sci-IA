<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Events | Green Cycle Drive</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <!-- NAVBAR -->
    <header class="navbar">
      <div class="nav-left">
        <img
          src="assets/logo-cropped.svg"
          alt="Green Cycle Drive Logo"
          class="logo"
        />
        <a href="index.html" class="GCD_Heading">
          <h1>The Green Cycle Drive</h1>
        </a>
      </div>
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="about.html">About Us</a>
        <a href="events.html">Events</a>
        <a href="team.html">Team</a>
        <a href="get_involved.html">Get Involved</a>
        <a href="#foot">Contact Us</a>
        <a href="login.html">
          <img
            src="https://avatars.githubusercontent.com/u/583231?v=4"
            class="profile-icon"
            alt="Profile Picture"
          />
        </a>
      </nav>
    </header>

    <!-- MAIN EVENTS SECTION -->
    <main class="container">
      <div id="eventsGrid" class="row g-4 justify-content-center"></div>
    </main>

    <!-- FOOTER -->
    <footer id="foot">
      <div class="footer-container">
        <div class="footer-column">
          <h3><a href="index.html">Home</a></h3>
          <p><a href="about.html">About</a></p>
          <p><a href="events.html">Events</a></p>
          <p><a href="team.html">Team</a></p>
          <p><a href="get_involved.html">Get Involved</a></p>
        </div>
        <div class="footer-column">
          <h3>Addresses</h3>
          <p>greencycledrive2025@gmail.com</p>
          <p>+971 58 894 3097</p>
          <p>GEMS Modern Academy, Dubai, UAE</p>
        </div>
        <div class="footer-column">
          <h3>Social</h3>
          <p>Instagram</p>
          <p>LinkedIn</p>
          <p>WhatsApp</p>
        </div>
        <div class="footer-column">
          <h3>Stay Connected</h3>
          <p>For any queries or concerns</p>
          <button><a href="get_involved.html">Send an Email</a></button>
        </div>
      </div>
      <div class="footer-note">
        <p>
          ¬© 2025 Made with ‚ù§Ô∏è by
          <em
            ><a href="https://xdmcshots.github.io/profile/"
              >Swarit Kapoor</a
            ></em
          >
        </p>
      </div>
    </footer>

    <!-- üåø FIREBASE SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    <script src="js/firebase-init.js"></script>

    <!-- üåø MAIN SCRIPT -->
    <script>
      const grid = document.getElementById("eventsGrid");

      // Convert Imgur link ‚Üí direct image
      function convertImgurLink(url) {
        if (!url) return "";
        const match = url.match(/imgur\.com\/(?:a\/|gallery\/)?([a-zA-Z0-9]+)/);
        if (match && match[1]) {
          return `https://i.imgur.com/${match[1]}.jpg`;
        }
        return url;
      }

      // Load Events
      function loadEvents() {
        db.collection("events")
          .orderBy("date", "desc")
          .onSnapshot((snap) => {
            grid.innerHTML = "";

            if (snap.empty) {
              grid.innerHTML =
                '<p class="text-center text-muted">No events available at the moment.</p>';
              return;
            }

            snap.forEach((doc) => {
              const e = doc.data();

              grid.innerHTML += `
                <div class="col-12 col-md-6 col-lg-4">
                  <div class="event-card h-100">
                    <img
                      src="${convertImgurLink(e.image)}"
                      onerror="this.src='https://via.placeholder.com/600x300?text=Event';"
                      alt="Event Image"
                    >
                    <div class="event-card-body">
                      <h5 class="event-card-title">${
                        e.title || "Untitled Event"
                      }</h5>
                      <p class="event-card-text">${
                        e.description || "No description provided."
                      }</p>
                      ${
                        e.date
                          ? `<p class="event-card-date"><i class="bi bi-calendar-event"></i> ${e.date}</p>`
                          : ""
                      }
                    </div>
                  </div>
                </div>`;
            });
          });
      }

      loadEvents();
    </script>

    <!-- BOOTSTRAP JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
